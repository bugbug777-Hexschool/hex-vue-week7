"use strict";(self["webpackChunkdemo"]=self["webpackChunkdemo"]||[]).push([[694],{3694:function(e,t,l){l.r(t),l.d(t,{default:function(){return ze}});var a=l(3396),o=l(7139);const d={class:"container | p-3"},s=(0,a._)("h1",null,"訂單列表",-1),r={class:"table"},n=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{width:"120"},"建立日期"),(0,a._)("th",{width:"120"},"訂單編號"),(0,a._)("th",{width:"240"},"購買品項"),(0,a._)("th",{width:"120"},"付款狀態"),(0,a._)("th",{width:"120"},"其他操作")])],-1),i={class:"ps-0 mb-0"},c={key:0,class:"text-success"},u={key:1},m=["onClick"],_=["onClick"],p={class:"d-flex justify-content-end"};function b(e,t,l,b,h,w){const g=(0,a.up)("Pagination"),y=(0,a.up)("OrderModal"),v=(0,a.up)("DelOrderModal");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",d,[s,(0,a._)("table",r,[n,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(h.orders,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("td",null,(0,o.zw)(new Date(1e3*e.create_at).toISOString().split("T")[0]),1),(0,a._)("td",null,(0,o.zw)(e.id),1),(0,a._)("td",null,[(0,a._)("ul",i,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.products,(e=>((0,a.wg)(),(0,a.iD)("li",{key:e.id,class:"list-unstyled"},(0,o.zw)(`${e.product.title} * ${e.qty} ${e.product.unit}`),1)))),128))])]),(0,a._)("td",null,[e.is_paid?((0,a.wg)(),(0,a.iD)("span",c,"已付款")):((0,a.wg)(),(0,a.iD)("span",u,"未付款"))]),(0,a._)("td",null,[(0,a._)("button",{onClick:t=>w.open_modal(e,"edit"),type:"button",class:"btn btn-sm btn-primary | me-1"}," 詳細資訊 ",8,m),(0,a._)("button",{onClick:t=>w.open_modal(e),type:"button",class:"btn btn-sm btn-outline-danger"}," 刪除 ",8,_)])])))),128))])]),(0,a._)("div",p,[(0,a.Wm)(g,{pagination:h.pagination,onUpdate:w.get_orders},null,8,["pagination","onUpdate"])])]),(0,a.Wm)(y,{ref:"orderModal",onUpdate:w.get_orders},null,8,["onUpdate"]),(0,a.Wm)(v,{ref:"delOrderModal",onUpdate:w.get_orders},null,8,["onUpdate"])],64)}var h=l(9242);const w={id:"orderModal",ref:"orderModal",class:"modal fade",tabindex:"-1","aria-labelledby":"orderModalLabel","aria-hidden":"true"},g={class:"modal-dialog modal-xl"},y={class:"modal-content border-0"},v={class:"modal-header bg-dark text-white"},f={id:"orderModalLabel",class:"modal-title"},k=(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),x={class:"modal-body"},D={class:"row"},M={class:"col-7"},$=(0,a._)("h2",{class:"mb-3"},"訂單資訊",-1),O={class:"table"},U=(0,a._)("th",null,"訂單編號：",-1),z=(0,a._)("th",null,"建立日期：",-1),C=(0,a._)("th",null,"付款方式",-1),S=(0,a._)("th",null,"訂單金額：",-1),V=(0,a._)("h2",{class:"mb-3"},"購買品項",-1),H={class:"table"},Y={class:"col-5"},q=(0,a._)("h2",{class:"mb-3"},"顧客資訊",-1),L={class:"row | mb-3"},P=(0,a._)("label",{for:"name",class:"col-sm-2 col-form-label | text-nowrap | me-2"},"顧客姓名：",-1),Z={class:"col-sm-9"},j={class:"row | mb-3"},E=(0,a._)("label",{for:"tel",class:"col-sm-2 col-form-label | text-nowrap | me-2"},"顧客電話：",-1),I={class:"col-sm-9"},K={class:"row | mb-3"},T=(0,a._)("label",{for:"email",class:"col-sm-2 col-form-label | text-nowrap | me-2"},"顧客信箱：",-1),W={class:"col-sm-9"},A={class:"row | mb-3"},B=(0,a._)("label",{for:"address",class:"col-sm-2 col-form-label | text-nowrap | me-2"},"顧客地址：",-1),F={class:"col-sm-9"},G={class:"row | mb-3"},J=(0,a._)("label",{for:"message",class:"col-sm-2 col-form-label | text-nowrap | me-2"},"顧客留言：",-1),N={class:"col-sm-9"},Q={class:"row | mb-3"},R=(0,a._)("label",{class:"col-sm-2 col-form-label | text-nowrap | me-2",for:"isPaid"},"付款狀態：",-1),X={class:"col-sm-9 d-flex align-items-center"},ee={class:"modal-footer"},te=(0,a._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1),le={key:1,type:"button",class:"btn btn-primary","data-bs-dismiss":"modal"};function ae(e,t,l,d,s,r){return(0,a.wg)(),(0,a.iD)("div",w,[(0,a._)("div",g,[(0,a._)("div",y,[(0,a._)("div",v,[(0,a._)("h5",f,[(0,a._)("span",null,"訂單編號："+(0,o.zw)(s.order.id),1)]),k]),(0,a._)("div",x,[(0,a._)("div",D,[(0,a._)("div",M,[$,(0,a._)("table",O,[(0,a._)("tbody",null,[s.order.create_at?((0,a.wg)(),(0,a.iD)(a.HY,{key:0},[(0,a._)("tr",null,[U,(0,a._)("td",null,(0,o.zw)(s.order.id),1)]),(0,a._)("tr",null,[z,(0,a._)("td",null,(0,o.zw)(new Date(s.order.create_at).toISOString().split("T")[0]),1)]),(0,a._)("tr",null,[C,(0,a._)("td",null,(0,o.zw)(s.order.payment_method||"尚未選擇付款方式"),1)]),(0,a._)("tr",null,[S,(0,a._)("td",null,(0,o.zw)(s.order.total),1)])],64)):(0,a.kq)("",!0)])]),V,(0,a._)("table",H,[(0,a._)("tbody",null,[s.order.create_at?((0,a.wg)(!0),(0,a.iD)(a.HY,{key:0},(0,a.Ko)(s.order.products,((e,t)=>((0,a.wg)(),(0,a.iD)("tr",{key:t},[(0,a._)("td",null,(0,o.zw)(`${e.product.title} * ${e.qty} ${e.product.unit}`),1)])))),128)):(0,a.kq)("",!0)])])]),(0,a._)("div",Y,[q,(0,a._)("div",L,[P,(0,a._)("div",Z,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.user.name=e),type:"text",id:"name",class:"form-control-plaintext",style:{padding:"6px 12px"},readonly:""},null,512),[[h.nr,s.user.name]])])]),(0,a._)("div",j,[E,(0,a._)("div",I,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>s.user.tel=e),type:"tel",id:"tel",class:"form-control"},null,512),[[h.nr,s.user.tel]])])]),(0,a._)("div",K,[T,(0,a._)("div",W,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>s.user.email=e),type:"email",id:"email",class:"form-control"},null,512),[[h.nr,s.user.email]])])]),(0,a._)("div",A,[B,(0,a._)("div",F,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>s.user.address=e),type:"text",id:"address",class:"form-control"},null,512),[[h.nr,s.user.address]])])]),(0,a._)("div",G,[J,(0,a._)("div",N,[(0,a.wy)((0,a._)("textarea",{"onUpdate:modelValue":t[4]||(t[4]=e=>s.order.message=e),type:"text",id:"message",class:"form-control"},null,512),[[h.nr,s.order.message]])])]),(0,a._)("div",Q,[R,(0,a._)("div",X,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>s.order.is_paid=e),class:"form-check-input | mt-0",type:"checkbox",value:"",id:"isPaid"},null,512),[[h.e8,s.order.is_paid]])])])])])]),(0,a._)("div",ee,[te,s.hasEdited?((0,a.wg)(),(0,a.iD)("button",{key:0,onClick:t[6]||(t[6]=(...e)=>r.edit_order&&r.edit_order(...e)),type:"button",class:"btn btn-primary"}," 儲存 ")):((0,a.wg)(),(0,a.iD)("button",le,"確認"))])])])],512)}var oe=l(7972),de=l.n(oe),se={data(){return{modal:"",order:{},user:{},hasEdited:!1}},watch:{order:{handler(e,t){0!==Object.keys(t).length&&(this.hasEdited=!0)},deep:!0}},methods:{open_modal(e){this.order={...e},this.user={...e.user},this.modal.show()},edit_order(){const e=`https://vue3-course-api.hexschool.io/v2/api/sihle/admin/order/${this.order.id}`,t=this.order;this.$http.put(e,{data:t}).then((e=>{e.data.success&&(this.$emit("update"),this.modal.hide())})).catch((e=>{console.log(e.response)}))},to_iso_string(e){console.log(typeof e);const t=new Date(1e3*e),l=t.toISOString().split("T").join(" ");return l}},mounted(){this.modal=new(de())(this.$refs.orderModal)}},re=l(89);const ne=(0,re.Z)(se,[["render",ae]]);var ie=ne;const ce={id:"delOrderModal",ref:"delOrderModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delOrderModalLabel","aria-hidden":"true"},ue={class:"modal-dialog"},me={class:"modal-content border-0"},_e={class:"modal-header bg-danger text-white"},pe={id:"delOrderModalLabel",class:"modal-title"},be=(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),he={class:"modal-body"},we=(0,a.Uk)(" 是否刪除編號為 "),ge={class:"text-danger"},ye=(0,a.Uk)(" 的此筆訂單(刪除後將無法恢復)。 "),ve={class:"modal-footer"},fe=(0,a._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function ke(e,t,l,d,s,r){return(0,a.wg)(),(0,a.iD)("div",ce,[(0,a._)("div",ue,[(0,a._)("div",me,[(0,a._)("div",_e,[(0,a._)("h5",pe,[(0,a._)("span",null,"刪除訂單："+(0,o.zw)(s.order.id),1)]),be]),(0,a._)("div",he,[we,(0,a._)("strong",ge,(0,o.zw)(s.order.id),1),ye]),(0,a._)("div",ve,[fe,(0,a._)("button",{onClick:t[0]||(t[0]=(...e)=>r.delete_order&&r.delete_order(...e)),type:"button",class:"btn btn-danger"},"確認刪除")])])])],512)}var xe={data(){return{modal:"",order:{}}},methods:{open_modal(e){this.order=e,this.modal.show()},delete_order(){const e=`https://vue3-course-api.hexschool.io/v2/api/sihle/admin/order/${this.order.id}`;this.$http.delete(e).then((e=>{e.data.success&&(this.$emit("update"),this.modal.hide())})).catch((e=>{console.log(e.response)}))}},mounted(){this.modal=new(de())(this.$refs.delOrderModal)}};const De=(0,re.Z)(xe,[["render",ke]]);var Me=De,$e=l(5500),Oe={components:{OrderModal:ie,DelOrderModal:Me,Pagination:$e.Z},data(){return{orders:[],pagination:{}}},methods:{get_orders(e=1){const t=`https://vue3-course-api.hexschool.io/v2/api/sihle/admin/orders?page=${e}`;this.$http.get(t).then((e=>{e.data.success&&(this.orders=e.data.orders,this.pagination=e.data.pagination)}))},open_modal(e,t){"edit"===t?this.$refs.orderModal.open_modal(e):this.$refs.delOrderModal.open_modal(e)}},mounted(){this.get_orders()}};const Ue=(0,re.Z)(Oe,[["render",b]]);var ze=Ue}}]);
//# sourceMappingURL=694.5a50cc7e.js.map